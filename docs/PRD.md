# 커피 주문 앱

## 1. 프로젝트 개요

### 1.1 프로젝트명
    커피 주문 앱

### 1.2 프로젝트 목적
    사용자가 커피 메뉴를 주문하고 관리자가 주문을 관리할 수 있는 간단한 풀스택 웹 앱

### 1.3 개발 범위
    - 주문하기 화면(메뉴 선택 및 장바구니 기능)
    - 관리자 화면(재고 관리 및 주문 상태 관리)
    - 데이타를 생성/조회/수정/삭제할 수 있는 기능

## 2. 기술 스택
    - Frontend: React, HTML, CSS, JavaScript
    - Backend: Node.js, Express
    - Database: PostgreSQL

## 3. 기본 사항
    - 프런트엔드와 백엔드를 따로 개발
    - 기본적인 웹 기술만 사용
    - 학습 목적이므로 사용자 인증이나 결제 기능은 제외
    - 메뉴는 커피 메뉴만 있음
    - **데이터 영속성**: PostgreSQL 데이터베이스를 사용하여 서버 재시작 후에도 주문 및 재고 데이터를 영구적으로 유지함.

## 4. 화면별 상세 요구사항

### 4.1 주문하기 화면 (Customer Order Page)
사용자가 메뉴를 확인하고 장바구니에 담아 주문을 진행하는 화면입니다.

#### 4.1.1 레이아웃 구성
- **헤더 (Header)**
    - 배경색: 반투명 화이트 (글래스모피즘 효과, backdrop-filter 적용)
    - 로고 및 네비게이션 색상: 다크 에스프레소 (#3d2b1f)
    - 좌측: 서비스 로고 ('COZY')
    - 우측: 네비게이션 메뉴 ('MENU', 'ADMIN')
    - 현재 위치에 따라 활성화된 메뉴 하단에 부드러운 하이라이트 효과 적용
- **레이아웃**
    - 전체 컨텐츠는 중앙 정렬 (Max-width: 1200px)
    - **디자인 컨셉**: "Premium Espresso & Warm Cream" - 브라운과 베이지 톤의 조화, 부드러운 그림자와 글래스 카드 스타일 적용
- **메뉴 리스트 영역**
    - 격자(Grid) 형태로 메뉴 카드들이 배치됨 (반투명 유리 질감 효과)
- **장바구니 영역 (Bottom Fixed Footer)**
    - 화면 하단 전체에 고정된 푸터(Footer) 형태로 존재
    - **구조 개편**: 왼쪽(장바구니 타이틀 및 세로 주문 목록), 오른쪽(총합계 금액 및 수직 배치된 주문하기 버튼)
    - 본문 하단에 장바구니 높이만큼의 유동적 여백(Padding)을 두어 마지막 메뉴까지 가림 없이 노출됨

#### 4.1.2 주요 기능 요구사항
- **메뉴 카드 (Menu Card)**
    - **이미지**: 메뉴 이미지 표시 (상단 영역)
    - **메뉴 정보**: 메뉴명(예: 아메리카노(ICE)), 가격(예: 4,000원), 간단한 설명 표시
    - **옵션 선택**: 체크박스를 통해 옵션 추가 가능
        - 샷 추가 (+500원)
        - 시럽 추가 (0원)
    - **담기 버튼**: 클릭 시 선택한 옵션과 함께 메뉴가 장바구니에 추가됨
        - 추가 성공 시 토스트(Toast) 메시지로 사용자에게 알림
- **장바구니 (Cart)**
    - **목록 표시**: 메뉴명, 선택 옵션, 수량, 개별 합계 금액을 한 줄씩 세로로 정렬
    - **수량 관리**: 
        - 동일 메뉴(동일 옵션 포함)는 합산하여 표시
        - 장바구니 내 각 아이템 옆에 작은 `+`, `-` 버튼을 제공하여 즉시 수량 변경 가능
    - **총액 계산**: 담긴 모든 메뉴의 총 금액을 "총금액 : 00,000원" 형태로 우측 상단에 강조 표시
- **주문하기 기능**
    - **버튼 디자인**: 다크 에스프레소 배경의 라운드 버튼으로 우측 하단 배치
    - **재고 검증**: 주문 시 실시간 재고 확인 및 부족 시 경고 안내
    - **주문 처리**: 주문 데이터 생성, 재고 차감, 장바구니 비우기 및 초기화 프로세스 진행
    - **결과 알림 (Premium Modal)**: 주문 성공 시 브라우저 알림창 대신 체크 애니메이션이 포함된 **프리미엄 커스텀 모달**을 표시하여 사용자에게 성공적인 피드백 제공

### 4.2 관리자 화면 (Admin Dashboard Page)
관리자가 주문 현황을 파악하고, 메뉴의 재고를 관리하며, 주문 상태를 제어하는 화면입니다.

#### 4.2.1 레이아웃 구성
- **헤더 (Header)**
    - 주문하기 화면과 동일하며, '관리자' 메뉴가 활성화됨
- **관리자 대시보드 (Dashboard)**
    - 현재 운영 현황을 한눈에 볼 수 있는 요약 정보창
- **재고 현황 (Inventory Management)**
    - 메뉴별 현재 재고 수량을 확인하고 수정할 수 있는 영역
- **주문 현황 (Order Management)**
    - 시간순으로 나열된 주문 목록 및 상태 변경 영역

#### 4.2.2 주요 기능 요구사항
- **대시보드 요약 정보**
    - **총 주문 수**: 당일 발생한 전체 주문 건수
    - **주문 접수**: 아직 조리가 시작되지 않은 주문 건수
    - **제조 중**: 현재 조리 중인 주문 건수
    - **제조 완료**: 조리가 완료되어 픽업 대기 중인 주문 건수
- **재고 현황 관리**
    - **수량 및 상태 표시**: 각 메뉴별 현재 남아있는 재고 수량 표시
        - **정상**: 재고 5개 이상
        - **주의**: 재고 5개 미만 (주황색 강조)
        - **품절**: 재고 0개 (빨간색 강조)
    - **재고 수정**: `+` 및 `-` 버튼을 통해 재고 수량을 1단위로 즉시 증감 가능
- **주문 현황 및 상태 제어**
    - **주문 상세 정보**: 주문 일자 및 시간, 메뉴명(옵션 포함), 수량, 가격 표시
    - **상태 처리 버튼**: 현재 주문의 다음 단계로 상태를 전환하는 버튼 (눈에 잘 띄는 **Solid 스타일** 배지 적용)
        - '제조 시작' 클릭 시: '주문 접수' -> '제조 중'
        - '제조 완료' 클릭 시: '제조 중' -> '제조 완료'
    - **취소 기능**: '주문 접수' 상태인 주문에 대해 **'취소하기'** 버튼 제공
        - **디자인**: 조작 실수 방지를 위해 상대적으로 무채색(Muted) 톤 적용
        - **안전 장치**: 클릭 시 경고 아이콘과 재고 복구 안내가 포함된 **커스텀 확인 모달** 노출
    - **레이아웃**: 모든 상태 버튼과 취소 버튼은 한 줄(Single Line)로 깔끔하게 정렬됨
    - **상태 흐름**: 주문 접수 -> 제조 중 -> 제조 완료 또는 주문 접수 -> 취소됨

## 5. 백엔드 및 데이터베이스 상세 요구사항

### 5.1 데이터 모델 (Data Model)

- **Menus (메뉴)**
    - ID: 고유 식별자
    - 이름 (name): 커피 메뉴 이름
    - 설명 (description): 메뉴에 대한 간단한 설명
    - 가격 (price): 기본 판매 가격
    - 이미지 (image): 메뉴 이미지 파일 경로 또는 URL
    - 재고 수량 (stock): 현재 판매 가능한 수량
- **Options (옵션)**
    - ID: 고유 식별자
    - 옵션 이름 (name): 옵션 명칭 (예: 샷 추가, 시럽 추가)
    - 옵션 가격 (price): 옵션 선택 시 추가되는 금액
    - 메뉴 ID (menu_id): 해당 옵션이 속한 메뉴 (Menus 테이블 참조)
- **Orders (주문)**
    - ID: 고유 식별자
    - 주문 일시 (created_at): 주문이 생성된 날짜와 시간
    - 총 금액 (total_price): 전체 주문 합계 금액
    - 주문 상태 (status): 현재 상태 (주문 접수 / 제조 중 / 제조 완료 / 취소됨)
    - 주문 내용 (items): 주문한 메뉴 리스트, 수량, 선택 옵션, 금액 등을 포함 (`order_items` 테이블과 조인하여 관리)

### 5.2 데이터 흐름 및 사용자 시나리오

1.  **메뉴 로드**: 사용자가 앱에 접속하면 시스템은 `Menus` 및 `Options` 데이터를 조회하여 화면에 표시합니다. 관리자 화면에는 특히 `stock` 정보를 함께 노출합니다.
2.  **장바구니 담기**: 사용자가 선택한 메뉴와 옵션 정보는 클라이언트 사이드의 장바구니에 임시 저장됩니다.
3.  **주문 생성**: 장바구니에서 '주문하기' 버튼을 클릭하면 주문 생성 API가 호출됩니다. 이때 주문 시간과 상세 내용이 `Orders` 테이블에 기록됩니다.
4.  **재고 차감**: 주문이 성공적으로 생성되면 관련 메뉴(`Menus`)의 재고 수량이 주문 수량만큼 감소합니다.
5.  **관리자 확인 및 상태 변경**: `Orders`에 저장된 정보는 관리자 화면의 '주문 현황' 목록에 표시됩니다. 관리자가 버튼을 클릭하여 상태를 업데이트합니다.
6.  **주문 취소 및 재고 복구**: 관리자가 주문을 취소할 경우, 해당 주문에 포함된 아이템들의 수량만큼 해당 메뉴의 **재고(`stock`)가 자동으로 복구(Restocking)** 되어 데이터 무결성을 유지합니다.

### 5.3 API 설계 (API Design)

- **메뉴 조회 (GET /api/menu)**: 데이터베이스에서 모든 커피 메뉴와 각 메뉴별 선택 가능한 옵션 목록을 불러옵니다.
- **주문 생성 (POST /api/orders)**: 장바구니 데이터를 받아 `orders` 및 `order_items` 테이블에 정보를 저장하고, 메뉴 재고를 실시간으로 차감합니다.
- **주문 목록 조회 (GET /api/admin/orders)**: (관리자용) 실시간 주문 내역과 포함된 상세 정보 조회
- **주문 상태 업데이트 (PATCH /api/admin/orders/:id)**: (관리자용) 주문 상태 변경 ('주문 접수' -> '제조 중' -> '제조 완료')
- **재고 수량 수정 (PATCH /api/admin/menu/:id/stock)**: (관리자용) 메뉴의 재고 수량을 즉시 업데이트
    